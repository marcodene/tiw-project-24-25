<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Playlist - Home</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <h1>Music Playlist</h1>
            </div>
            <div class="user-nav">
                <p th:text="${'Hello, ' + session.user.name + ' ' + session.user.surname}"></p>
                <a th:href="@{/Logout}" class="logout-btn">Logout</a>
            </div>
        </header>
        
        <!-- Playlists List Section -->
        <section class="section">
            <div class="card">
                <div class="card-header">
                    <h2>Your Playlists</h2>
                </div>
                
                <div class="playlist-grid" th:if="${not #lists.isEmpty(playlists)}">
                    <div class="playlist-card" th:each="playlist : ${playlists}">
                        <div class="playlist-title">
                            <a th:href="@{/GoToPlaylistPage(playlistId=${playlist.ID})}" th:text="${playlist.name}"></a>
                        </div>
                        <div class="playlist-date" th:text="${#dates.format(playlist.creationDate, 'dd-MM-yyyy')}"></div>
                        <div th:if="${jsVersion}" class="playlist-actions">
                            <a th:href="@{#}" th:onclick="'openReorderModal(' + ${playlist.ID} + ');'" class="btn-secondary">Reorder</a>
                        </div>
                    </div>
                </div>
                
                <p th:if="${#lists.isEmpty(playlists)}">You don't have any playlists yet. Create one below!</p>
            </div>
        </section>
        
        <div class="form-columns">
            <!-- Upload Song Form Section -->
            <section class="section">
                <div class="card">
                    <div class="card-header">
                        <h2>Upload a New Song</h2>
                    </div>
                    
                    <form th:action="@{/UploadSong}" method="POST" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="songName">Song Title</label>
                            <input type="text" id="songName" name="songName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="albumName">Album Title</label>
                            <input type="text" id="albumName" name="albumName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="artistName">Artist/Group Name</label>
                            <input type="text" id="artistName" name="artistName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="albumReleaseYear">Release Year</label>
                            <input type="number" id="albumReleaseYear" name="albumReleaseYear" 
                                min="1600" th:max="${#dates.format(#dates.createNow(), 'yyyy')}" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="genre">Genre</label>
                            <select id="genre" name="genre" required>
                                <option value="">Select Genre</option>
                                <option th:each="genre : ${genres}" th:value="${genre}" th:text="${genre}"></option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="albumCover">Album Cover Image</label>
                            <input type="file" id="albumCover" name="albumCover" accept="image/*">
                        </div>
                        
                        <div class="form-group">
                            <label for="songFile">Music File</label>
                            <input type="file" id="songFile" name="songFile" accept="audio/*">
                        </div>
                        
                        <button type="submit">Upload Song</button>
                    </form>
                </div>
            </section>
            
            <!-- Create Playlist Form Section -->
            <section class="section">
                <div class="card">
                    <div class="card-header">
                        <h2>Create a New Playlist</h2>
                    </div>
                    
                    <form th:action="@{/CreatePlaylist}" method="POST">
                        <div class="form-group">
                            <label for="playlistName">Playlist Title</label>
                            <input type="text" id="playlistName" name="playlistName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="selectedSongs">Select Songs</label>
                            <select id="selectedSongs" name="selectedSongs" multiple required>
                                <option th:each="song : ${songs}" 
                                        th:value="${song.name}" 
                                        th:text="${song.name + ' - ' + song.artistName + ' (' + song.albumName + ', ' + song.albumReleaseYear + ')'}">
                                </option>
                            </select>
                            <small>Hold Ctrl (Cmd on Mac) to select multiple songs</small>
                        </div>
                        
                        <button type="submit">Create Playlist</button>
                    </form>
                </div>
            </section>
        </div>
    </div>
</body>
</html>